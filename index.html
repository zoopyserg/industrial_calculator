<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Конфігуратор системи сонячних панелей</title>
    <!-- Vue.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <!-- Tailwind CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- DaisyUI -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@2.14.1/dist/full.css" rel="stylesheet">
    <!-- Дополнительные стили -->
    <style>
        /* Ваши стили здесь */
    </style>
</head>
<body class="bg-gray-200 min-h-screen flex items-center justify-center">
    <div id="app" class="max-w-5xl mx-auto py-10 px-5 bg-white rounded-lg shadow-lg">
        <h1 class="text-3xl font-bold text-center mb-6">Конфігуратор системи сонячних панелей</h1>

        <!-- Шаг 1: Ввод мощности или расчет потребления -->
        <div v-if="step === 1">
            <h2 class="text-xl font-semibold mb-4">Крок 1: Введіть відому потужність або допоможіть нам розрахувати</h2>
            <div class="mb-6">
                <label class="block mb-2 font-semibold">Відома потужність (Вт):</label>
                <input type="number" v-model.number="knownWatts" class="input input-bordered w-full" placeholder="Введіть потужність в ватах">
            </div>
            <div class="mb-6">
                <label class="block mb-2 font-semibold">Час автономної роботи (годин):</label>
                <input type="number" v-model.number="autonomyHours" class="input input-bordered w-full" placeholder="Введіть час в годинах">
            </div>
            <div class="flex justify-between mt-6">
                <button class="py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-blue-600" @click="nextStep" :disabled="!canProceed">Далі</button>
                <button class="py-2 px-4 bg-gray-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-gray-600" @click="goToApplianceSelection">Допомогти розрахувати</button>
            </div>
        </div>

        <!-- Шаг 1.2: Выбор бытовой техники -->
        <div v-if="step === 1.2">
            <h2 class="text-xl font-semibold mb-4">Крок 1.2: Оберіть побутові прилади</h2>
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-2">Швидкий вибір пакетів:</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="p-4 bg-gray-100 rounded-lg cursor-pointer hover:bg-gray-200" @click="selectPackage('basic')">
                        <h4 class="font-bold mb-2">Базовий</h4>
                        <p>Освітлення, зарядка телефонів, Wi-Fi роутер</p>
                    </div>
                    <div class="p-4 bg-gray-100 rounded-lg cursor-pointer hover:bg-gray-200" @click="selectPackage('comfort')">
                        <h4 class="font-bold mb-2">Комфорт</h4>
                        <p>Холодильник, телевізор, ноутбук</p>
                    </div>
                    <div class="p-4 bg-gray-100 rounded-lg cursor-pointer hover:bg-gray-200" @click="selectPackage('luxury')">
                        <h4 class="font-bold mb-2">Лакшері</h4>
                        <p>Кондиціонер, електроплита, пральна машина</p>
                    </div>
                </div>
            </div>
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-2">Виберіть прилади та час їх використання:</h3>
                <div v-for="appliance in appliances" :key="appliance.name" class="flex items-center mb-4">
                    <input type="checkbox" v-model="appliance.selected" class="checkbox checkbox-primary mr-4">
                    <div class="w-full">
                        <div class="flex justify-between items-center">
                            <label class="font-semibold">{{ appliance.label }} ({{ appliance.power }} Вт)</label>
                            <div class="flex items-center">
                                <label class="mr-2">Годин/добу:</label>
                                <input type="number" v-model.number="appliance.hours" :disabled="!appliance.selected" class="input input-bordered w-24">
                            </div>
                        </div>
                        <p class="text-gray-500">{{ appliance.description }}</p>
                    </div>
                </div>
            </div>
            <div class="flex justify-between mt-6">
                <button class="py-2 px-4 bg-gray-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-gray-600" @click="prevStep">Назад</button>
                <button class="py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-blue-600" @click="calculateFromAppliances">Розрахувати потужність</button>
            </div>
        </div>

        <!-- Шаг 2: Предложение комплектов -->
        <div v-if="step === 2">
            <h2 class="text-xl font-semibold mb-4">Крок 2: Оберіть рекомендований комплект</h2>
            <div v-for="kit in recommendedKits" :key="kit.name" class="mb-6 p-4 bg-gray-100 rounded-lg">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="font-bold text-lg">{{ kit.name }}</h3>
                        <p class="text-gray-500">{{ kit.description }}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-xl font-bold">₴{{ formatPrice(kit.totalPrice) }}</p>
                        <button class="py-2 px-4 bg-green-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-green-600 mt-2" @click="selectKit(kit)">Обрати</button>
                    </div>
                </div>
                <div class="mt-4">
                    <button @click="kit.showDetails = !kit.showDetails" class="text-blue-500 hover:underline">
                        {{ kit.showDetails ? 'Приховати деталі' : 'Показати деталі' }}
                    </button>
                    <div v-if="kit.showDetails" class="mt-4">
                        <!-- Детали комплекта -->
                        <h4 class="font-semibold">Склад комплекту:</h4>
                        <ul class="list-disc list-inside">
                            <li><strong>Інвертор:</strong> {{ kit.inverter.model }} — ₴{{ formatPrice(kit.inverter.price) }}</li>
                            <li><strong>Акумулятори:</strong> {{ kit.batteries.quantity }} × {{ kit.batteries.model }} — ₴{{ formatPrice(kit.batteries.totalPrice) }}</li>
                            <li><strong>Сонячні панелі:</strong> {{ kit.panels.quantity }} × {{ kit.panels.model }} — ₴{{ formatPrice(kit.panels.totalPrice) }}</li>
                            <li><strong>Комплектуючі та монтаж:</strong> ₴{{ formatPrice(kit.accessories.price) }}</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="flex justify-between mt-6">
                <button class="py-2 px-4 bg-gray-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-gray-600" @click="prevStep">Назад</button>
                <button class="py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-blue-600" @click="nextStep" :disabled="!selectedKit">Далі</button>
            </div>
        </div>

        <!-- Шаг 3: Дополнительные параметры -->
        <div v-if="step === 3">
            <h2 class="text-xl font-semibold mb-4">Крок 3: Додаткові параметри</h2>
            <div class="mb-6">
                <label class="block mb-2 font-semibold">Ціль встановлення системи:</label>
                <select v-model="additionalParams.goal" class="select select-bordered w-full">
                    <option value="">Оберіть ціль</option>
                    <option value="income">Пасивний дохід</option>
                    <option value="independence">Повна незалежність від електромережі</option>
                    <option value="backup">Резервне електроживлення</option>
                    <option value="savings">Економія електроенергії</option>
                    <option value="increase">Збільшення потужності</option>
                    <option value="other">Інше</option>
                </select>
            </div>
            <div class="mb-6">
                <label class="block mb-2 font-semibold">Причина встановлення:</label>
                <select v-model="additionalParams.reason" class="select select-bordered w-full">
                    <option value="">Оберіть причину</option>
                    <option value="voltage">Погана якість напруги</option>
                    <option value="outages">Часті відключення</option>
                    <option value="bills">Великі рахунки за електрику</option>
                    <option value="no_grid">Відсутність електромережі</option>
                </select>
            </div>
            <div class="mb-6">
                <label class="block mb-2 font-semibold">Плановане розміщення:</label>
                <select v-model="additionalParams.location" class="select select-bordered w-full">
                    <option value="">Оберіть місце</option>
                    <option value="roof">На даху</option>
                    <option value="ground">На землі</option>
                    <option value="canopy">Навіси</option>
                </select>
            </div>
            <div class="flex justify-between mt-6">
                <button class="py-2 px-4 bg-gray-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-gray-600" @click="prevStep">Назад</button>
                <button class="py-2 px-4 bg-green-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-green-600" @click="submitForm">Завершити</button>
            </div>
        </div>

        <!-- Шаг 4: Итоговый заказ -->
        <div v-if="step === 4">
            <h2 class="text-xl font-semibold mb-4">Підсумок</h2>
            <div class="bg-gray-100 p-4 rounded-lg space-y-4">
                <h3 class="font-bold text-lg">Вибраний комплект:</h3>
                <ul class="list-disc list-inside">
                    <li><strong>Інвертор:</strong> {{ selectedKit.inverter.model }} — ₴{{ formatPrice(selectedKit.inverter.price) }}</li>
                    <li><strong>Акумулятори:</strong> {{ selectedKit.batteries.quantity }} × {{ selectedKit.batteries.model }} — ₴{{ formatPrice(selectedKit.batteries.totalPrice) }}</li>
                    <li><strong>Сонячні панелі:</strong> {{ selectedKit.panels.quantity }} × {{ selectedKit.panels.model }} — ₴{{ formatPrice(selectedKit.panels.totalPrice) }}</li>
                    <li><strong>Комплектуючі та монтаж:</strong> ₴{{ formatPrice(selectedKit.accessories.price) }}</li>
                </ul>
                <div class="text-xl font-bold text-right">
                    <span>Загальна вартість: ₴{{ formatPrice(selectedKit.totalPrice) }}</span>
                </div>
            </div>
            <div class="mt-6">
                <h3 class="font-bold text-lg">Додаткова інформація:</h3>
                <p><strong>Ціль:</strong> {{ additionalParamsLabels.goalLabel }}</p>
                <p><strong>Причина:</strong> {{ additionalParamsLabels.reasonLabel }}</p>
                <p><strong>Розміщення:</strong> {{ additionalParamsLabels.locationLabel }}</p>
            </div>
            <div class="flex justify-between mt-6">
                <button class="py-2 px-4 bg-gray-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-gray-600" @click="startOver">Почати спочатку</button>
                <button class="py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg cursor-pointer transition hover:bg-blue-600" @click="generatePDF">Зберегти в PDF</button>
            </div>
        </div>

    </div>

    <!-- Vue.js код -->
      <!-- Vue.js код -->
    <script>
        new Vue({
            el: '#app',
            data: {
                step: 1,
                knownWatts: null,
                autonomyHours: null,
                appliances: [
                    // Базовая категория
                    { name: 'led_lamp', label: 'LED лампа', power: 10, hours: 5, selected: false, description: 'Освітлення', category: 'basic', defaultHours: 5 },
                    { name: 'wifi_router', label: 'Wi-Fi роутер', power: 10, hours: 24, selected: false, description: 'Інтернет', category: 'basic', defaultHours: 24 },
                    { name: 'smartphone_charge', label: 'Зарядка смартфона', power: 5, hours: 3, selected: false, description: 'Зарядка телефонів', category: 'basic', defaultHours: 3 },
                    // Комфорт категория
                    { name: 'fridge', label: 'Холодильник', power: 150, hours: 8, selected: false, description: 'Зберігання продуктів', category: 'comfort', defaultHours: 8 },
                    { name: 'tv', label: 'Телевізор', power: 100, hours: 4, selected: false, description: 'Розваги', category: 'comfort', defaultHours: 4 },
                    { name: 'laptop', label: 'Ноутбук', power: 60, hours: 6, selected: false, description: 'Робота та розваги', category: 'comfort', defaultHours: 6 },
                    // Лакшери категория
                    { name: 'air_conditioner', label: 'Кондиціонер', power: 1000, hours: 6, selected: false, description: 'Комфортна температура', category: 'luxury', defaultHours: 6 },
                    { name: 'electric_stove', label: 'Електроплита', power: 2000, hours: 2, selected: false, description: 'Приготування їжі', category: 'luxury', defaultHours: 2 },
                    { name: 'washing_machine', label: 'Пральна машина', power: 500, hours: 1, selected: false, description: 'Прання одягу', category: 'luxury', defaultHours: 1 },
                ],
                recommendedKits: [],
                selectedKit: null,
                additionalParams: {
                    goal: '',
                    reason: '',
                    location: ''
                },
                goals: {
                    income: 'Пасивний дохід',
                    independence: 'Повна незалежність від електромережі',
                    backup: 'Резервне електроживлення',
                    savings: 'Економія електроенергії',
                    increase: 'Збільшення потужності',
                    other: 'Інше'
                },
                reasons: {
                    voltage: 'Погана якість напруги',
                    outages: 'Часті відключення',
                    bills: 'Великі рахунки за електрику',
                    no_grid: 'Відсутність електромережі'
                },
                locations: {
                    roof: 'На даху',
                    ground: 'На землі',
                    canopy: 'Навіси'
                }
            },
            computed: {
                canProceed() {
                    return this.knownWatts > 0 && this.autonomyHours > 0;
                },
                totalEnergy() {
                    return this.knownWatts * this.autonomyHours;
                },
                selectedAppliances() {
                    return this.appliances.filter(appliance => appliance.selected);
                },
                calculatedWatts() {
                    return this.selectedAppliances.reduce((sum, appliance) => sum + appliance.power, 0);
                },
                calculatedEnergy() {
                    return this.selectedAppliances.reduce((sum, appliance) => sum + (appliance.power * appliance.hours), 0);
                },
                additionalParamsLabels() {
                    return {
                        goalLabel: this.goals[this.additionalParams.goal] || '',
                        reasonLabel: this.reasons[this.additionalParams.reason] || '',
                        locationLabel: this.locations[this.additionalParams.location] || ''
                    };
                }
            },
            methods: {
                nextStep() {
                    if (this.step === 1) {
                        this.calculateKits();
                    }
                    this.step++;
                },
                prevStep() {
                    this.step--;
                },
                goToApplianceSelection() {
                    this.step = 1.2;
                },
                selectPackage(category) {
                    this.appliances.forEach(appliance => {
                        appliance.selected = appliance.category === category;
                        appliance.hours = appliance.defaultHours;
                    });
                },
                calculateFromAppliances() {
                    this.knownWatts = this.calculatedWatts;
                    this.autonomyHours = Math.max(...this.selectedAppliances.map(appliance => appliance.hours));
                    this.calculateKits();
                    this.step = 2;
                },
                calculateKits() {
                    const totalEnergy = this.selectedAppliances.length > 0 ? this.calculatedEnergy : this.totalEnergy;
                    // На основе totalEnergy подобрать комплекты
                    this.recommendedKits = this.getRecommendedKits(totalEnergy);
                },
                getRecommendedKits(totalEnergy) {
                    // Пример данных комплектов
                    const kits = [
                        {
                            name: 'Комплект 5 кВт',
                            description: 'Підходить для базових потреб.',
                            inverter: { model: 'Growatt SPF 5000 ES', price: 22000 },
                            batteries: { model: 'Pylontech US2000B Plus', quantity: 4, totalPrice: 152000 },
                            panels: { model: 'Сонячна панель 330 Вт', quantity: 15, totalPrice: 75000 },
                            accessories: { price: 20000 },
                            totalPrice: 269000,
                            showDetails: false
                        },
                        {
                            name: 'Комплект 8 кВт',
                            description: 'Для середніх потреб.',
                            inverter: { model: 'Victron Multiplus-II 48/8000/110', price: 70000 },
                            batteries: { model: 'Pylontech US2000B Plus', quantity: 6, totalPrice: 228000 },
                            panels: { model: 'Сонячна панель 330 Вт', quantity: 24, totalPrice: 120000 },
                            accessories: { price: 30000 },
                            totalPrice: 448000,
                            showDetails: false
                        },
                        {
                            name: 'Комплект 10 кВт',
                            description: 'Для високих потреб.',
                            inverter: { model: 'Victron Quattro 48/10000/140', price: 90000 },
                            batteries: { model: 'Pylontech US2000B Plus', quantity: 8, totalPrice: 304000 },
                            panels: { model: 'Сонячна панель 330 Вт', quantity: 30, totalPrice: 150000 },
                            accessories: { price: 35000 },
                            totalPrice: 579000,
                            showDetails: false
                        }
                    ];

                    // Фильтрация комплектов на основе totalEnergy
                    if (totalEnergy <= 20000) {
                        return [kits[0]];
                    } else if (totalEnergy <= 35000) {
                        return [kits[1]];
                    } else {
                        return [kits[2]];
                    }
                },
                selectKit(kit) {
                    this.selectedKit = kit;
                },
                formatPrice(price) {
                    return price.toLocaleString('uk-UA');
                },
                submitForm() {
                    this.step++;
                },
                startOver() {
                    // Сброс всех данных
                    this.step = 1;
                    this.knownWatts = null;
                    this.autonomyHours = null;
                    this.appliances.forEach(appliance => {
                        appliance.selected = false;
                        appliance.hours = appliance.defaultHours;
                    });
                    this.recommendedKits = [];
                    this.selectedKit = null;
                    this.additionalParams = {
                        goal: '',
                        reason: '',
                        location: ''
                    };
                },
                generatePDF() {
                    // Здесь вы можете реализовать функцию генерации PDF
                    alert('Функція генерації PDF ще не реалізована.');
                }
            }
        });
    </script>
</body>
</html>
