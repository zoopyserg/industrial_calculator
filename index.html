<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Конфігуратор сонячних панелей</title>
    <!-- Vue.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <!-- Tailwind CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Подключение иконок Heroicons -->
    <script src="https://unpkg.com/heroicons@1.0.6/dist/outline.js"></script>
</head>
<body class="bg-gray-200 min-h-screen flex items-center justify-center">
    <div id="app" class="max-w-4xl mx-auto py-10 px-5 bg-white rounded-lg shadow-lg">
        <h1 class="text-3xl font-bold text-center mb-6">Конфігуратор системи сонячних панелей</h1>

        <!-- Шаг 1: Выбор типа системы -->
        <div v-if="step === 1">
            <h2 class="text-xl font-semibold mb-4">Крок 1: Оберіть тип системи</h2>
            <div class="space-y-4">
                <div
                    v-for="type in systemTypes"
                    :key="type.value"
                    @click="selectType(type.value)"
                    :class="['p-4 bg-gray-200 rounded-lg cursor-pointer border-2 transition transform duration-300 flex items-center',
                    { 'bg-blue-50 border-blue-500': selectedType === type.value }]"
                >
                    <input
                        type="radio"
                        :id="type.value"
                        v-model="selectedType"
                        :value="type.value"
                        class="mr-2"
                    >
                    <label :for="type.value" class="inline-block cursor-pointer w-full">{{ type.label }}</label>
                </div>
            </div>
            <div class="flex justify-between mt-6">
                <span></span>
                <button class="py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-blue-600 hover:scale-105" @click="nextStep" :disabled="!selectedType">Далі</button>
            </div>
        </div>

        <!-- Шаг 2: Выбор опций -->
        <div v-if="step === 2">
            <h2 class="text-xl font-semibold mb-4">Крок 2: Оберіть опції</h2>
            <div class="space-y-3">
                <div v-for="option in filteredOptions" :key="option.name" class="flex items-center space-x-3">
                    <input
                        type="checkbox"
                        :id="option.name"
                        v-model="option.selected"
                        class="hidden"
                    >
                    <label :for="option.name" class="flex items-center px-4 py-2 bg-gray-200 rounded-lg cursor-pointer border-2 transition transform duration-300" :class="{ 'bg-blue-50 border-blue-500': option.selected }">
                        <input type="checkbox" class="mr-2" :checked="option.selected" @change="toggleOption(option)">
                        {{ option.label }} (Ціна: ₴{{ option.price }})
                    </label>
                </div>
            </div>
            <div class="flex justify-between mt-6">
                <button class="py-2 px-4 bg-gray-500 text-white font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-gray-600 hover:scale-105" @click="prevStep">Назад</button>
                <button class="py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-blue-600 hover:scale-105" @click="nextStep">Далі</button>
            </div>
        </div>

        <!-- Шаг 3: Количество панелей и другие параметры -->
        <div v-if="step === 3">
            <h2 class="text-xl font-semibold mb-4">Крок 3: Введіть кількість панелей та інші параметри</h2>
            <label class="block mb-4">
                Кількість панелей:
                <input
                    type="number"
                    v-model="panelCount"
                    min="1"
                    max="100"
                    class="p-2 w-full border border-gray-300 rounded-lg"
                >
            </label>
            <div class="flex items-center space-x-3 mb-6">
                <input
                    type="checkbox"
                    id="needBatteries"
                    v-model="needBatteries"
                    class="hidden"
                >
                <label for="needBatteries" class="flex items-center px-4 py-2 bg-gray-200 rounded-lg cursor-pointer border-2 transition transform duration-300" :class="{ 'bg-blue-50 border-blue-500': needBatteries }">
                    <input type="checkbox" class="mr-2" :checked="needBatteries" @change="needBatteries = !needBatteries">
                    Потрібні акумулятори (Ціна: ₴500 за одиницю)
                </label>
            </div>
            <div class="flex justify-between">
                <button class="py-2 px-4 bg-gray-500 text-white font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-gray-600 hover:scale-105" @click="prevStep">Назад</button>
                <button class="py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-blue-600 hover:scale-105" @click="nextStep">Показати підсумок</button>
            </div>
        </div>

        <!-- Шаг 4: Итоговый заказ -->
        <div v-if="step === 4">
            <h2 class="text-xl font-semibold mb-4">Підсумок</h2>
            <div class="bg-gray-100 p-4 rounded-lg space-y-4">
                <div v-for="(option, index) in selectedOptions" :key="option.name" class="flex justify-between items-center">
                    <span>{{ option.label }} (x{{ option.quantity }})</span>
                    <div class="flex space-x-2 items-center">
                        <button @click="decrementQuantity(option)" class="py-1 px-2 bg-gray-300 text-gray-700 font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-gray-400">-</button>
                        <span>₴{{ option.price * option.quantity }}</span>
                        <button @click="incrementQuantity(option)" class="py-1 px-2 bg-gray-300 text-gray-700 font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-gray-400">+</button>
                        <button @click="removeOption(option)" class="py-1 px-1 bg-red-500 text-white font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-red-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="flex justify-between items-center" v-if="needBatteries">
                    <span>Акумулятори</span>
                    <span>₴{{ 500 * panelCount }}</span>
                </div>
                <div class="flex justify-between items-center">
                    <span>Кількість панелей</span>
                    <span>{{ panelCount }}</span>
                </div>
                <div class="text-xl font-bold text-right">
                    <span>Загальна вартість: ₴{{ totalCost }}</span>
                </div>
            </div>
            <div class="flex justify-between mt-6">
                <button class="py-2 px-4 bg-gray-500 text-white font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-gray-600 hover:scale-105" @click="prevStep">Назад</button>
                <button class="py-2 px-4 bg-green-500 text-white font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-green-600 hover:scale-105" @click="addMoreOptions">Додати більше</button>
                <button class="py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg cursor-pointer transition transform duration-300 hover:bg-blue-600 hover:scale-105" @click="saveAsPDF">Зберегти в PDF</button>
            </div>
        </div>
    </div>

    <!-- Vue.js код -->
    <script>
        new Vue({
            el: '#app',
            data: {
                step: 1,
                selectedType: '',
                panelCount: 1,
                needBatteries: false,
                systemTypes: [
                    { label: 'Автономна система', value: 'autonomous' },
                    { label: 'Мережева система', value: 'grid' },
                    { label: 'Гібридна система', value: 'hybrid' },
                ],
                options: [
                    { name: 'mounting', label: 'Кріплення для панелей', price: 200, selected: false, quantity: 1, applicableTo: ['autonomous', 'grid', 'hybrid'] },
                    { name: 'controller', label: 'Контролер заряду', price: 150, selected: false, quantity: 1, applicableTo: ['autonomous', 'hybrid'] },
                    { name: 'battery', label: 'Акумуляторна батарея', price: 500, selected: false, quantity: 1, applicableTo: ['autonomous', 'hybrid'] },
                    { name: 'inverter', label: 'Інвертор', price: 700, selected: false, quantity: 1, applicableTo: ['grid', 'hybrid'] },
                    { name: 'ecoflow', label: 'EcoFlow станція', price: 1000, selected: false, quantity: 1, applicableTo: ['autonomous'] },
                    { name: 'monitoring', label: 'Система моніторингу', price: 300, selected: false, quantity: 1, applicableTo: ['grid', 'hybrid'] },
                ],
            },
            computed: {
                filteredOptions() {
                    return this.options.filter(option => option.applicableTo.includes(this.selectedType));
                },
                selectedOptions() {
                    return this.filteredOptions.filter(option => option.selected);
                },
                totalCost() {
                    let cost = this.selectedOptions.reduce((sum, option) => sum + (option.price * option.quantity), 0);
                    if (this.needBatteries) cost += 500 * this.panelCount;
                    return cost;
                }
            },
            methods: {
                selectType(type) {
                    this.selectedType = type;
                },
                toggleOption(option) {
                    option.selected = !option.selected;
                },
                incrementQuantity(option) {
                    option.quantity++;
                },
                decrementQuantity(option) {
                    if (option.quantity > 1) option.quantity--;
                },
                nextStep() {
                    this.step++;
                },
                prevStep() {
                    this.step--;
                },
                removeOption(option) {
                    option.selected = false;
                    option.quantity = 1; // Сбросить количество при удалении
                },
                addMoreOptions() {
                    this.step = 2;
                },
                saveAsPDF() {
                    alert('Збереження в PDF не реалізовано в цьому MVP.');
                }
            }
        });
    </script>
</body>
</html>
